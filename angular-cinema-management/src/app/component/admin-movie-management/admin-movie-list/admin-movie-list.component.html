<div class="container py-2">
  <header class="p-2 border-bottom header">
    <div class="container-fluid">
      <div class="container">
        <div class="d-flex flex-wrap align-items-center justify-content-center justify-content-lg-start">
          <a href="/" class="align-items-center mb-2 link-body-emphasis text-decoration-none flex-fill">
            <img id="headerIMG" src="../../../../assets/logo_movie-removebg.png" />
          </a>
          <div class="dropdown text-end">
            <a href="#" class="d-block link-dark text-decoration-none dropdown-toggle" data-bs-toggle="dropdown"
               aria-expanded="false">
              <img src="https://github.com/mdo.png" alt="mdo" width="32" height="32" class="rounded-circle">
            </a>
            <ul class="dropdown-menu text-small">
              <li><a class="dropdown-item" href="#">Cài đặt</a></li>
              <li><a class="dropdown-item" href="#">Trang cá nhân</a></li>
              <li>
                <hr class="dropdown-divider">
              </li>
              <li><a class="dropdown-item" href="#">Đăng xuất</a></li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!--    Sidebar      -->
  <div class="row">
    <div class="col-lg-3">
      <div class="card mb-4">
        <div class="card-header rounded-1" style="background-color: rgba(0, 0, 0, 0)">
          <div class="d-block justify-content-center">
            <ul class="nav nav-pills flex-column flex-shrink-0 mb-auto">
              <li class="nav-item">
                <a href="#" class="nav-link link-dark" aria-current="page">
                  <i class="fas fa-solid fa-ticket" style="color: #ffffff;"></i>
                  Bán vé
                </a>
              </li>
              <li>
                <a href="#" class="nav-link link-dark">
                  <i class="fa-sharp fa-solid fa-bars-progress"></i>&ensp;Quản lý đặt vé
                  Quản lý đặt vé
                </a>
              </li>
              <li>
                <a href="#" class="nav-link link-dark">
                  <i class="fa-solid fa-user"></i> &ensp;Quản lý nhân viên
                  Quản lý nhân viên
                </a>
              </li>
              <li>
                <a href="#" class="nav-link link-dark ">
                  <i class="fa-solid fa-address-card"></i>
                  Quản lý thành viên
                </a>
              </li>
              <li>
                <a href="#" class="nav-link link-dark active">
                  <i class="fa-solid fa-film"></i>
                  Quản lý phim
                </a>
              </li>
              <li>
                <a href="#" class="nav-link link-dark">
                  <i class="fas fa-qrcode"></i>
                  Quản lý khuyến mãi
                </a>
              </li>
              <li>
                <a href="#" class="nav-link link-dark">
                  <i class="fas fa-video"></i>
                  Quản lý phòng chiếu
                </a>
              </li>
              <li>
                <a href="#" class="nav-link link-dark">
                  <svg width="18" height="18">
                    <use xlink:href="#speedometer2"/>
                  </svg>
                  Thống kê
                </a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
    <!--    main-->
    <div class="col-lg-9">
      <div class="col">
        <div class="card">
          <div class="bg-light card card-header p-3 mb-4 text-uppercase display fw-bold" style="float: left">
            <div class="row">
              <div class="col 7">
                Quản lý danh sách phim
              </div>

              <div class="col-3">
                <button class="bg-sub btn" data-bs-toggle="modal" data-bs-target="#searchModal">Tìm kiếm</button>
              </div>

              <div class="col-3">
                <button class="bg-sub btn">Thêm Phim</button>
              </div>
            </div>

            <div class="card-body">
              <div class="table-responsive table-bordered rounded shadow">
                <table class="table table-striped table-hover text-center">
                  <thead style="background-color: #F26B38; color: #fff;">
                  <tr>
                    <th>#</th>
                    <th class="center_number">Phim</th>
                    <th>Hãng phim</th>
                    <th>Ngày chiếu</th>
                    <th>Thời Lượng(m)</th>
                    <th>Sửa</th>
                    <th>thông tin</th>
                    <th>Xóa</th>
                  </tr>
                  </thead>
                  <tbody>
                  <tbody>
                  <tr *ngFor="let list of list;index as i">
                    <td>{{i + 1}}</td>
                    <td>{{list.name}}</td>
                    <td>{{list.movieStudio}}</td>
                    <td>{{list.startDay | date:'dd/MM/yyyy'}}</td>
                    <td>{{list.timeAmount}}</td>
                    <td>
                      <button type="button" class="btn">
                        <i class="bi bi-pencil-square bg-icon"></i>
                      </button>
                    </td>
                    <td>
                      <button type="button" class="btn">
                        <i data-bs-toggle="modal" data-bs-target="#detailsModal" (click)="findById(list.id)"
                           class=" bi bi-info-circle bg-icon"></i>

                      </button>
                    </td>
                    <td>
                      <button type="button" class="btn" data-bs-toggle="modal"
                              data-bs-target="#deleteModal" (click)="findById(list.id)">
                        <i class="bi bi-trash3 bg-icon"></i>
                      </button>
                    </td>
                  </tr>
                  </tbody>
                </table>
                <div>
                  <ul class="pagination justify-content-center">
                    <li class="page-item">
                      <a class="page-link" *ngIf="pageNumber != 0 ? 'disable': ''">
                        <i class="fa-solid fa-backward-fast"
                           (click)="findAllWithCondition(name_search,startDay_search,timeAmount_search,studios_search,0)"></i>
                      </a>
                    </li>
                    <li>
                      <a class="page-link" *ngIf="pageNumber != 0 ? 'disable': ''">
                        <i class="fa-solid fa-backward"
                           (click)="findAllWithCondition(name_search,startDay_search,timeAmount_search,studios_search,pageNumber - 1)"></i>
                      </a>
                    </li>
                    <li class="page-item" *ngFor="let item of [].constructor(totalPages); let i = index">
                      <a class="page-link" [ngClass]="pageNumber == i ? 'current': ''"
                         (click)="findAllWithCondition(name_search,startDay_search,timeAmount_search,studios_search,i)">
                        {{i + 1}}
                      </a>
                    </li>
                    <li>
                      <a class="page-link" *ngIf="pageNumber < totalPages - 1 ? 'disable': ''">
                        <i class="fa-solid fa-forward"
                           (click)="findAllWithCondition(name_search,startDay_search,timeAmount_search,studios_search,pageNumber + 1)"></i>
                      </a>
                    </li>
                    <li class="page-item">
                      <a class="page-link" *ngIf="pageNumber < totalPages - 1 ? 'disable': ''"
                         (click)="findAllWithCondition(name_search,startDay_search,timeAmount_search,studios_search,totalPages - 1)">
                        <i class="fa-solid fa-forward-fast"></i> </a>
                    </li>
                    <li class="page-item">
                      <span class="page-link">{{pageNumber + 1}} / {{totalPages}}</span>
                    </li>
                    <li class="page-item">
                      <div class="input-group rounded">
                        <input type="search" class="form-control rounded" placeholder="chọn trong {{totalPages}} trang"
                               #element
                               id="pageChoice"
                               aria-label="Search" aria-describedby="search-addon"/>
                        <span class="input-group-text border-0" id="search-addon">
                          <i class="fas fa-search" (click)="getPageInChoice(+element.value - 1)"></i>
                        </span>
                      </div>
                    </li>
                  </ul>
                </div>
                <ng-template #isEmpty class="clearfix">
                  <div style="font-size: 18px; margin-left: 73px" class="hint-text">Không tìm thấy vé phù hợp với từ
                    khoá<b>"" </b></div>
                </ng-template>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!--delete modal-->
<div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        Bạn có muốn xóa <span id="name_delete"></span>
        <input hidden id="id_delete" #id_delete>
      </div>
      <div class="modal-footer">
        <p style="color: red">*Lưu ý: Hành động này không thể hoàn tác, bạn có chắc chắn muốn xóa?</p>
        <button type="button" class="btn bg-sub" data-bs-dismiss="modal">Đóng</button>
        <button type="button" class="btn bg-close" (click)="deleteThis(id_delete.value)">Xóa</button>
      </div>
    </div>
  </div>
</div>
<!--Search Modal -->
<div class="modal fade" id="searchModal" tabindex="-1" aria-labelledby="exampleModalLabel1" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel1">Modal title</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <input type="text" placeholder="Tên phim cần tìm" #name id="nameSearch"
               (change)="name_search = name.value.trim()">
        <input type="date" placeholder="ngày cần tìm" #startDay id="dateSearch"
               (change)="startDay_search=startDay.value.trim()">
        <input type="text" placeholder="thời lượng" #time id="timeSearch"
               (change)="timeAmount_search = time.value.trim()">
        <input type="text" placeholder="nhà sản xuất" #studios id="studioSearch"
               (change)="studios_search = studios.value.trim()">
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"  #deleteClose >Close</button>
        <button type="button" class="btn btn-primary"  (click)="searchWithCondition()">Save changes</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="detailsModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Thông tin chi tiết Phim</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"
                (click)="refreshPage()"></button>
      </div>
      <div class="modal-body" style="height: 350px">
        <table border='0' width='100%'>
          <tbody>
          <tr >
            <td> <img id="detailIMG" [src]="movieDetail.image" ></td>
            <td style="padding:20px;">
              <p>Tên phim : {{movieDetail.name}}</p>
              <p>Nhà sản xuất: {{movieDetail.movieStudio}}</p>
              <p>Thời lượng: {{movieDetail.timeAmount }}</p>
              <p>Ngày chiếu: {{movieDetail.startDay| date:'dd/MM/yyyy'}}</p>
              <p>Diễn viên: {{movieDetail.movieActor}}</p>
              <p>thể loại: {{movieDetail.movieType}}</p>
              <p>Giới thiệu: {{movieDetail.movieDirector}}</p>
            </td>
          </tr>
          </tbody>
        </table>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" (click)="refreshPage()">Hủy</button>
      </div>
    </div>
  </div>
</div>
